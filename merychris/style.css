:root {
  --bg: #d9d9d9;
  --paper-1: #f8efe4;
  --paper-2: #efe2d3;
  --paper-edge: #d8c4ad;
  --paper-shadow: rgba(98, 72, 44, 0.13);
  --ink: #312114;
  --gold-1: #f3d8a1;
  --gold-2: #b9873e;
  --gold-3: #8a6028;
  --wax-a: #b60d20;
  --wax-b: #7f0411;
  --wax-c: #d72035;
}

* {
  box-sizing: border-box;
}

html,
body {
  margin: 0;
  min-height: 100%;
}

body {
  font-family: "Cormorant Garamond", "Times New Roman", serif;
  overflow: hidden;
  color: var(--ink);
  background: var(--bg);
}

.ambience {
  position: fixed;
  inset: 0;
  pointer-events: none;
  background:
    radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.35), transparent 38%),
    radial-gradient(circle at 65% 78%, rgba(0, 0, 0, 0.07), transparent 40%);
}

.stage {
  min-height: 100vh;
  display: grid;
  place-items: center;
  padding: clamp(12px, 2vw, 22px);
  perspective: 1200px;
}

.envelope-shell {
  width: min(92vw, 1060px);
  aspect-ratio: 1.55 / 1;
}

.envelope {
  --tilt-x: 0deg;
  --tilt-y: 0deg;
  position: relative;
  width: 100%;
  height: 100%;
  border-radius: clamp(10px, 1.4vw, 16px);
  overflow: hidden;
  transform: rotateX(var(--tilt-x)) rotateY(var(--tilt-y));
  transition: transform 220ms ease;
  box-shadow:
    0 2px 0 rgba(255, 255, 255, 0.8) inset,
    0 -2px 0 rgba(165, 134, 97, 0.18) inset,
    0 10px 16px rgba(83, 59, 35, 0.16),
    0 36px 54px rgba(56, 38, 21, 0.14);
}

.paper-base,
.flap {
  position: absolute;
  inset: 0;
  background:
    radial-gradient(circle at 20% 18%, rgba(255, 255, 255, 0.35), transparent 38%),
    linear-gradient(160deg, var(--paper-1), var(--paper-2));
}

.paper-base::before,
.flap::before {
  content: "";
  position: absolute;
  inset: 0;
  opacity: 0.36;
  background:
    repeating-linear-gradient(0deg, rgba(111, 83, 52, 0.04) 0 1px, transparent 1px 4px),
    repeating-linear-gradient(90deg, rgba(111, 83, 52, 0.02) 0 1px, transparent 1px 5px);
}

.paper-base {
  z-index: 1;
}

.letter {
  position: absolute;
  left: 7.5%;
  right: 7.5%;
  top: 9%;
  bottom: 8%;
  z-index: 2;
  padding: clamp(1rem, 2.6vw, 2rem);
  border-radius: 8px;
  background:
    linear-gradient(180deg, #fffefb, #f8efe3 75%),
    repeating-linear-gradient(0deg, rgba(119, 84, 46, 0.06) 0 1px, transparent 1px 4px);
  box-shadow:
    inset 0 0 0 1px rgba(160, 124, 83, 0.15),
    0 8px 16px rgba(84, 58, 34, 0.16);
  transform: translateY(120%);
  opacity: 0;
  transition: transform 1000ms cubic-bezier(0.22, 0.84, 0.23, 1), opacity 280ms ease;
}

.letter-content {
  text-align: center;
  opacity: 0;
  transform: translateY(10px);
  transition: opacity 420ms ease, transform 420ms ease;
}

.eyebrow {
  margin: 0;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  font-size: clamp(0.7rem, 1.4vw, 1rem);
  color: #6f5233;
}

h1 {
  margin: 0.62rem 0 0.4rem;
  line-height: 1;
  font-size: clamp(2rem, 6vw, 4rem);
  font-weight: 600;
}

.date {
  margin: 0.2rem 0;
  font-size: clamp(1rem, 2.2vw, 1.45rem);
}

.location {
  margin: 0;
  font-size: clamp(1rem, 1.9vw, 1.3rem);
}

.hint {
  margin: 0.8rem 0 0;
  text-transform: uppercase;
  letter-spacing: 0.14em;
  color: #8b6430;
  font-size: clamp(0.72rem, 1.4vw, 0.92rem);
}

.string {
  position: absolute;
  top: -1%;
  bottom: -1%;
  width: max(2px, 0.22%);
  z-index: 6;
  background:
    linear-gradient(180deg, #ffe5b6, #c79042 40%, #916229 70%, #f3cd8e);
  box-shadow:
    0 0 0 1px rgba(136, 94, 41, 0.2),
    0 0 8px rgba(198, 151, 81, 0.18);
}

.string::before {
  content: "";
  position: absolute;
  inset: 0;
  opacity: 0.45;
  background: repeating-linear-gradient(180deg, rgba(255, 245, 220, 0.7) 0 3px, rgba(121, 84, 35, 0.35) 3px 6px);
}

.string-left {
  left: calc(50% - 0.7%);
}

.string-right {
  left: calc(50% + 0.35%);
}

.flap {
  z-index: 4;
  transition: transform 900ms cubic-bezier(0.24, 0.78, 0.2, 1), opacity 520ms ease;
}

.flap-top {
  z-index: 5;
  clip-path: polygon(0 0, 100% 0, 50% 55%);
  transform-origin: 50% 0;
  border-bottom: 1px solid rgba(177, 140, 99, 0.22);
  box-shadow: 0 8px 12px rgba(102, 76, 48, 0.08);
}

.flap-left {
  clip-path: polygon(0 0, 50% 55%, 0 100%);
  border-right: 1px solid rgba(177, 140, 99, 0.14);
}

.flap-right {
  clip-path: polygon(100% 0, 100% 100%, 50% 55%);
  border-left: 1px solid rgba(177, 140, 99, 0.14);
}

.flap-bottom {
  clip-path: polygon(0 100%, 100% 100%, 50% 55%);
  z-index: 3;
  border-top: 1px solid rgba(177, 140, 99, 0.2);
}

.flap-bottom::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 0 0 clamp(10px, 1.4vw, 16px) clamp(10px, 1.4vw, 16px);
  box-shadow: inset 0 -10px 16px rgba(118, 85, 51, 0.08);
}

.seal {
  position: absolute;
  left: 50%;
  top: 50%;
  width: clamp(92px, 11vw, 154px);
  aspect-ratio: 1;
  transform: translate(-50%, -50%);
  border: 0;
  border-radius: 50%;
  z-index: 8;
  cursor: pointer;
  color: #e6c786;
  background:
    radial-gradient(circle at 28% 22%, rgba(255, 144, 151, 0.5), transparent 34%),
    radial-gradient(circle at 75% 76%, rgba(67, 0, 5, 0.5), transparent 48%),
    conic-gradient(
      from 20deg,
      #d1162c 0deg 48deg,
      #8d0816 48deg 108deg,
      #c91126 108deg 178deg,
      #7a050f 178deg 240deg,
      #b70f23 240deg 302deg,
      #78040e 302deg 360deg
    );
  box-shadow:
    inset 0 5px 8px rgba(255, 177, 184, 0.26),
    inset 0 -13px 14px rgba(74, 1, 10, 0.46),
    0 8px 16px rgba(70, 10, 15, 0.35),
    0 0 0 1px rgba(85, 4, 12, 0.45);
  transition: transform 220ms ease, opacity 280ms ease, filter 320ms ease;
}

.seal::before {
  content: "";
  position: absolute;
  inset: 8%;
  border-radius: 50%;
  border: 2px solid rgba(104, 3, 13, 0.58);
  box-shadow:
    inset 0 1px 2px rgba(255, 198, 206, 0.18),
    inset 0 -2px 3px rgba(84, 4, 12, 0.4);
}

.seal::after {
  content: "";
  position: absolute;
  inset: 19%;
  border-radius: 50%;
  background:
    radial-gradient(circle at 36% 28%, rgba(255, 162, 174, 0.24), transparent 44%),
    linear-gradient(155deg, rgba(103, 4, 13, 0.45), rgba(203, 24, 43, 0.22));
  box-shadow:
    inset 0 3px 4px rgba(82, 2, 11, 0.5),
    inset 0 -2px 3px rgba(255, 188, 197, 0.15);
}

.seal-inner {
  position: relative;
  z-index: 2;
  font-family: "Great Vibes", cursive;
  font-size: clamp(2.2rem, 4.3vw, 4rem);
  line-height: 1;
  text-shadow:
    0 -1px 0 rgba(255, 227, 169, 0.65),
    0 1px 2px rgba(106, 62, 18, 0.72);
}

.seal:hover {
  transform: translate(-50%, -50%) scale(1.03);
}

.seal:focus-visible {
  outline: 3px solid rgba(187, 32, 48, 0.34);
  outline-offset: 3px;
}

.envelope.is-unsealing .seal {
  pointer-events: none;
  transform: translate(-50%, -50%) scale(1.06);
}

.envelope.is-opening .seal,
.envelope.is-revealed .seal {
  opacity: 0;
  transform: translate(-50%, -42%) scale(0.56) rotate(-14deg);
  filter: blur(1px);
}

.envelope.is-opening .flap-top,
.envelope.is-revealed .flap-top {
  transform: rotateX(-176deg);
}

.envelope.is-opening .flap-left,
.envelope.is-revealed .flap-left {
  transform: translateX(-70%);
  opacity: 0;
}

.envelope.is-opening .flap-right,
.envelope.is-revealed .flap-right {
  transform: translateX(70%);
  opacity: 0;
}

.envelope.is-opening .string,
.envelope.is-revealed .string {
  opacity: 0;
  transition: opacity 300ms ease;
}

.envelope.is-revealed .letter {
  transform: translateY(0%);
  opacity: 1;
}

.envelope.is-revealed .letter-content {
  opacity: 1;
  transform: translateY(0);
}

@media (max-width: 700px) {
  .envelope-shell {
    width: min(95vw, 620px);
    aspect-ratio: 1.22 / 1;
  }

  .seal {
    width: clamp(84px, 17vw, 132px);
  }
}

@media (prefers-reduced-motion: reduce) {
  .envelope,
  .flap,
  .seal,
  .letter,
  .letter-content,
  .string {
    transition: none;
  }
}
